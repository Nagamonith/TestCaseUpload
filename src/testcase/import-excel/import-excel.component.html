<!-- src/app/tester/import-excel/import-excel.component.html -->

<div class="max-w-4xl mx-auto p-6 bg-white rounded-2xl shadow-lg space-y-6">
  <!-- Title -->
  <h2 class="text-2xl font-bold text-center text-blue-700">
     Import Test Cases from Excel
  </h2>

  <!-- Current Product Badge -->
  <div *ngIf="currentProduct()" class="text-center">
    <span class="inline-block bg-blue-100 text-blue-800 text-sm px-4 py-1.5 rounded-full font-semibold shadow-sm">
      Product: {{ currentProduct()?.name }}
    </span>
  </div>

  <!-- File Upload Section -->
  <section class="space-y-2">
    <label class="block text-sm font-medium text-gray-700">Upload Excel File (.xlsx)</label>
    <div class="flex items-center gap-3">
      <input 
        #fileInput
        type="file" 
        (change)="handleFileInput($event)" 
        accept=".xlsx,.xls"
        class="block w-full text-sm text-gray-600
          file:mr-4 file:py-2 file:px-4
          file:rounded-lg file:border-0
          file:text-sm file:font-semibold
          file:bg-blue-50 file:text-blue-700
          hover:file:bg-blue-100 cursor-pointer"
      />
      <button 
        *ngIf="fileName()" 
        (click)="cancelFile(fileInput)" 
        class="px-3 py-1.5 bg-red-100 text-red-700 rounded-md text-sm hover:bg-red-200 transition"
      >
        ✖ Remove
      </button>
    </div>
    <p *ngIf="fileName()" class="text-xs text-gray-500">Selected: {{ fileName() }}</p>
  </section>

  <!-- Loading State -->
  <div *ngIf="isLoading()" class="flex flex-col items-center py-10 text-gray-600">
    <div class="animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-blue-500"></div>
    <p class="mt-3">Processing Excel file...</p>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage()" class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-md" role="alert">
    <p class="font-medium">⚠ {{ errorMessage() }}</p>
  </div>

  <!-- Sheets Section -->
  <div *ngIf="sheetNames().length > 0" class="border rounded-lg overflow-hidden divide-y">
    <!-- Header -->
    <div class="bg-gray-50 px-5 py-3 flex justify-between items-center">
      <h4 class="font-semibold text-gray-700">
         Sheets Found: {{ sheetNames().length }}
      </h4>
      <!-- <button 
        (click)="saveData()" 
        class="px-4 py-2 bg-green-600 text-white rounded-md text-sm hover:bg-green-700 transition"
        [disabled]="!sheetData()"
      >
         Save All
      </button> -->
    </div>

    <!-- Sheet List -->
    <ul class="divide-y divide-gray-200">
      <li *ngFor="let name of sheetNames()" class="px-5 py-3 flex justify-between items-center hover:bg-gray-50">
        <div class="flex items-center space-x-2">
          <span class="text-gray-800 font-medium"> {{ name }}</span>
          <span class="text-xs text-gray-500">
            ({{ sheetData()?.[name]?.length || 0 }} rows)
          </span>
        </div>
        <div class="flex gap-2">
          <button 
            (click)="onSelectSheet(name)"
            class="px-3 py-1.5 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700 transition"
          >
             Map Columns
          </button>
          <button 
            (click)="onCancelSheet(name)"
            class="px-3 py-1.5 bg-red-100 text-red-700 rounded-md text-sm hover:bg-red-200 transition"
          >
            ✖ Remove
          </button>
        </div>
      </li>
    </ul>
  </div>
</div>
